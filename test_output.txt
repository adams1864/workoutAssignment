
> workout-assignment-api@1.0.0 test
> jest --coverage

PASS tests/integration/auth.test.js
  â— Console

    console.log
      DATABASE_URL in database.js: postgresql://workout_user:workout_pass@localhost:5432/workout_db_test?schema=public

      at Object.log (src/config/database.js:3:9)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: New user registered: newclient@example.com (CLIENT)

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: New user registered: newtrainer@example.com (TRAINER)

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Please provide a valid email address {"stack":"Error: Please provide a valid email address\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\validate.js:21:19\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:175:3)\n    at router (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:47:12)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:807:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:691:5","statusCode":400,"path":"/api/auth/register","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Password must be at least 6 characters long {"stack":"Error: Password must be at least 6 characters long\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\validate.js:21:19\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:175:3)\n    at router (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:47:12)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:807:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:691:5","statusCode":400,"path":"/api/auth/register","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: New user registered: duplicate@example.com (CLIENT)

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: User with this email already exists {"stack":"Error: User with this email already exists\n    at AuthService.register (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:19:13)\n    at register (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:13:20)","statusCode":409,"path":"/api/auth/register","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: User logged in: testuser@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Invalid email or password {"stack":"Error: Invalid email or password\n    at AuthService.login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:59:13)\n    at login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:35:22)","statusCode":401,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Invalid email or password {"stack":"Error: Invalid email or password\n    at AuthService.login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:66:13)\n    at login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:35:22)","statusCode":401,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Password is required {"stack":"Error: Password is required\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\validate.js:21:19\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:175:3)\n    at router (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:47:12)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:807:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:691:5","statusCode":400,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

FAIL tests/integration/workout.test.js
  â— Console

    console.log
      DATABASE_URL in database.js: postgresql://workout_user:workout_pass@localhost:5432/workout_db_test?schema=public

      at Object.log (src/config/database.js:3:9)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Invalid email or password {"stack":"Error: Invalid email or password\n    at AuthService.login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:59:13)\n    at login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:35:22)","statusCode":401,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Invalid email or password {"stack":"Error: Invalid email or password\n    at AuthService.login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:59:13)\n    at login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:35:22)","statusCode":401,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Invalid email or password {"stack":"Error: Invalid email or password\n    at AuthService.login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:59:13)\n    at login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:35:22)","statusCode":401,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[31merror[39m]: Invalid email or password {"stack":"Error: Invalid email or password\n    at AuthService.login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\authService.js:59:13)\n    at login (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\authController.js:35:22)","statusCode":401,"path":"/api/auth/login","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:17 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[31merror[39m]: Access denied. Required role: TRAINER {"stack":"Error: Access denied. Required role: TRAINER\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\roleMiddleware.js:19:15\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\authMiddleware.js:30:5)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:175:3)\n    at router (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:47:12)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:807:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:691:5","statusCode":403,"path":"/api/workouts","method":"GET"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:18 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: Workout ca4130a4-7190-461b-bfcc-5814316ffbbf assigned to client f7570057-ff7e-4340-9a0d-865a9b16af57 by trainer trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: Workout bcf3f2e3-a893-48af-be6a-8f70664bd117 assigned to client 05c84dc9-589f-4158-9c7a-f82874224de1 by trainer trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[31merror[39m]: Workout already assigned to this client {"stack":"Error: Workout already assigned to this client\n    at WorkoutService.assignWorkout (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\workoutService.js:119:13)\n    at assignWorkout (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\workoutController.js:64:26)","statusCode":409,"path":"/api/workouts/bcf3f2e3-a893-48af-be6a-8f70664bd117/assign","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[31merror[39m]: Workout not found {"stack":"Error: Workout not found\n    at WorkoutService.assignWorkout (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\services\\workoutService.js:88:13)\n    at assignWorkout (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\controllers\\workoutController.js:64:26)","statusCode":404,"path":"/api/workouts/00000000-0000-0000-0000-000000000000/assign","method":"POST"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:19 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[31merror[39m]: Access denied. Required role: CLIENT {"stack":"Error: Access denied. Required role: CLIENT\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\roleMiddleware.js:19:15\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\authMiddleware.js:30:5)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:175:3)\n    at router (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:47:12)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:807:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:691:5","statusCode":403,"path":"/api/workouts/my-workouts","method":"GET"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: User logged in: trainer@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: User logged in: client@example.com

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[31merror[39m]: No token provided {"stack":"Error: No token provided\n    at authenticate (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\src\\middleware\\authMiddleware.js:15:13)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:175:3)\n    at router (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:47:12)\n    at Layer.handle [as handle_request] (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:807:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Administrator\\workoutAssign\\workoutAssignment\\node_modules\\express-rate-limit\\dist\\index.cjs:691:5","statusCode":401,"path":"/api/workouts/my-workouts","method":"GET"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-12-19 17:57:20 [[32minfo[39m]: [object Object]

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

  â— Workout Integration Tests â€º POST /api/workouts â€º should allow trainer to create workout

    TypeError: Cannot read properties of undefined (reading 'token')

    [0m [90m 42 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)
     [90m 43 |[39m       [33m.[39msend({ email[33m:[39m [32m'trainer@example.com'[39m[33m,[39m password[33m:[39m [32m'password123'[39m })[33m;[39m
    [31m[1m>[22m[39m[90m 44 |[39m     trainerToken [33m=[39m trainerLogin[33m.[39mbody[33m.[39mdata[33m.[39mtoken[33m;[39m
     [90m    |[39m                                           [31m[1m^[22m[39m
     [90m 45 |[39m
     [90m 46 |[39m     [36mconst[39m clientLogin [33m=[39m [36mawait[39m request(app)
     [90m 47 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)[0m

      at Object.token (tests/integration/workout.test.js:44:43)

  â— Workout Integration Tests â€º POST /api/workouts â€º should return 403 when client tries to create workout

    TypeError: Cannot read properties of undefined (reading 'token')

    [0m [90m 42 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)
     [90m 43 |[39m       [33m.[39msend({ email[33m:[39m [32m'trainer@example.com'[39m[33m,[39m password[33m:[39m [32m'password123'[39m })[33m;[39m
    [31m[1m>[22m[39m[90m 44 |[39m     trainerToken [33m=[39m trainerLogin[33m.[39mbody[33m.[39mdata[33m.[39mtoken[33m;[39m
     [90m    |[39m                                           [31m[1m^[22m[39m
     [90m 45 |[39m
     [90m 46 |[39m     [36mconst[39m clientLogin [33m=[39m [36mawait[39m request(app)
     [90m 47 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)[0m

      at Object.token (tests/integration/workout.test.js:44:43)

  â— Workout Integration Tests â€º POST /api/workouts â€º should return 401 without authentication

    TypeError: Cannot read properties of undefined (reading 'token')

    [0m [90m 42 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)
     [90m 43 |[39m       [33m.[39msend({ email[33m:[39m [32m'trainer@example.com'[39m[33m,[39m password[33m:[39m [32m'password123'[39m })[33m;[39m
    [31m[1m>[22m[39m[90m 44 |[39m     trainerToken [33m=[39m trainerLogin[33m.[39mbody[33m.[39mdata[33m.[39mtoken[33m;[39m
     [90m    |[39m                                           [31m[1m^[22m[39m
     [90m 45 |[39m
     [90m 46 |[39m     [36mconst[39m clientLogin [33m=[39m [36mawait[39m request(app)
     [90m 47 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)[0m

      at Object.token (tests/integration/workout.test.js:44:43)

  â— Workout Integration Tests â€º POST /api/workouts â€º should return 400 for invalid workout data

    TypeError: Cannot read properties of undefined (reading 'token')

    [0m [90m 47 |[39m       [33m.[39mpost([32m'/api/auth/login'[39m)
     [90m 48 |[39m       [33m.[39msend({ email[33m:[39m [32m'client@example.com'[39m[33m,[39m password[33m:[39m [32m'password123'[39m })[33m;[39m
    [31m[1m>[22m[39m[90m 49 |[39m     clientToken [33m=[39m clientLogin[33m.[39mbody[33m.[39mdata[33m.[39mtoken[33m;[39m
     [90m    |[39m                                         [31m[1m^[22m[39m
     [90m 50 |[39m   })[33m;[39m
     [90m 51 |[39m
     [90m 52 |[39m   afterAll([36masync[39m () [33m=>[39m {[0m

      at Object.token (tests/integration/workout.test.js:49:41)

-----------------------|---------|----------|---------|---------|-------------------
File                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-----------------------|---------|----------|---------|---------|-------------------
All files              |   86.95 |    65.67 |   75.67 |   86.95 |                   
 src                   |   71.42 |      100 |       0 |   71.42 |                   
  app.js               |   71.42 |      100 |       0 |   71.42 | 45,58,70-73,78-81 
 src/config            |   93.75 |    66.66 |      50 |   93.75 |                   
  database.js          |   83.33 |       50 |       0 |   83.33 | 18                
  logger.js            |     100 |       75 |     100 |     100 | 25                
 src/controllers       |   79.54 |      100 |   83.33 |   79.54 |                   
  authController.js    |     100 |      100 |     100 |     100 |                   
  workoutController.js |   68.96 |      100 |      75 |   68.96 | 10-24,50,100      
 src/middleware        |   93.44 |    70.37 |     100 |   93.44 |                   
  authMiddleware.js    |     100 |      100 |     100 |     100 |                   
  errorHandler.js      |   81.25 |       50 |     100 |   81.25 | 23,28,33          
  requestLogger.js     |     100 |      100 |     100 |     100 |                   
  roleMiddleware.js    |   91.66 |    66.66 |     100 |   91.66 | 15                
  validate.js          |     100 |      100 |     100 |     100 |                   
 src/routes            |     100 |      100 |     100 |     100 |                   
  authRoutes.js        |     100 |      100 |     100 |     100 |                   
  workoutRoutes.js     |     100 |      100 |     100 |     100 |                   
 src/services          |   84.21 |    65.38 |    87.5 |   84.21 |                   
  authService.js       |    86.2 |    63.63 |     100 |    86.2 | 24,106-109        
  workoutService.js    |   82.14 |    66.66 |      75 |   82.14 | 10-27,92,101,105  
 src/utils             |     100 |    33.33 |     100 |     100 |                   
  errors.js            |     100 |    33.33 |     100 |     100 | 6-31              
 src/validators        |     100 |      100 |     100 |     100 |                   
  authValidator.js     |     100 |      100 |     100 |     100 |                   
  workoutValidator.js  |     100 |      100 |     100 |     100 |                   
-----------------------|---------|----------|---------|---------|-------------------
Jest: "global" coverage threshold for branches (70%) not met: 65.67%
Test Suites: 1 failed, 1 passed, 2 total
Tests:       4 failed, 18 passed, 22 total
Snapshots:   0 total
Time:        5.559 s, estimated 6 s
Ran all test suites.
